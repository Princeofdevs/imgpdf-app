{% extends "base.html" %}
{% block content %}
<div class="container">

    <div class="flex-row">

        <!-- IMAGE → PDF -->
        <section class="card">
            <h2>Image → PDF</h2>

            <form id="image-to-pdf-form" action="{{ url_for('image_to_pdf') }}" method="POST" enctype="multipart/form-data">
                <div class="options">
                    <div>
                        <label>Orientation</label>
                        <select name="orientation">
                            <option value="portrait">Portrait</option>
                            <option value="landscape">Landscape</option>
                        </select>
                    </div>
                    <div>
                        <label>Page Size</label>
                        <select name="pagesize">
                            <option value="a4">A4</option>
                            <option value="letter">Letter</option>
                        </select>
                    </div>
                    <div>
                        <label>Layout</label>
                        <select name="layout">
                            <option value="single">Single per page</option>
                            <option value="multiple">Multiple per page</option>
                        </select>
                    </div>
                </div>

                <label class="file-upload">
                    <input type="file" name="images" multiple required>
                    <div class="upload-inner">
                        <div class="upload-icon">
                            <i class="fas fa-cloud-upload-alt"></i>
                        </div>
                        <div class="upload-text">Click or Drag Images</div>
                    </div>
                    <div class="file-names" id="image-file-names"></div>
                </label>

                <button type="submit" class="btn">Convert to PDF</button>
            </form>

            {% if pdf_download_link %}
            <a href="{{ url_for('download_file', filename=pdf_download_link) }}" class="btn download">Download PDF</a>
            {% endif %}
        </section>

        <!-- PDF → IMAGE -->
        <section class="card">
            <h2>PDF → Images</h2>

            <form id="pdf-to-image-form" action="{{ url_for('pdf_to_image') }}" method="POST" enctype="multipart/form-data">
                <div class="options">
                    <div>
                        <label>Orientation</label>
                        <select name="orientation_pdf2img">
                            <option value="portrait">Portrait</option>
                            <option value="landscape">Landscape</option>
                        </select>
                    </div>
                    <div>
                        <label>Page Size</label>
                        <select name="pagesize_pdf2img">
                            <option value="a4">A4</option>
                            <option value="letter">Letter</option>
                        </select>
                    </div>
                    <div>
                        <label>Layout</label>
                        <select name="layout_pdf2img">
                            <option value="single">Single per page</option>
                            <option value="multiple">Multiple per page</option>
                        </select>
                    </div>
                </div>

                <label class="file-upload">
                    <input type="file" name="pdf" accept=".pdf" required>
                    <div class="upload-inner">
                        <div class="upload-icon">
                            <i class="fas fa-cloud-upload-alt"></i>
                        </div>
                        <div class="upload-text">Click or Drag PDF</div>
                    </div>
                    <div class="file-names" id="pdf-file-names"></div>
                </label>

                <button type="submit" class="btn">Convert to Images</button>
            </form>

            {% if image_download_links %}
            <div class="download-list">
                {% for img in image_download_links %}
                <a href="{{ url_for('download_file', filename=img) }}" class="btn download">Download {{ img }}</a>
                {% endfor %}
            </div>
            {% endif %}
        </section>

    </div>
    <!-- ADVERTISEMENT SECTION -->
<div class="ad-banner">
    <p>Reserved for Advertisement</p>
</div>
<!-- END ADVERTISEMENT SECTION -->
</div>

<script>
    // IMAGE → PDF: Show selected file names
    const imageInput = document.querySelector('input[name="images"]');
    const imageFileNames = document.getElementById('image-file-names');

    imageInput.addEventListener('change', () => {
        imageFileNames.innerHTML = '';
        Array.from(imageInput.files).forEach(f => {
            const div = document.createElement('div');
            div.className = 'file-name-item';
            div.textContent = f.name;
            imageFileNames.appendChild(div);
        });
    });

    // PDF → IMAGE: Show selected PDF file
    const pdfInput = document.querySelector('input[name="pdf"]');
    const pdfFileNames = document.getElementById('pdf-file-names');

    pdfInput.addEventListener('change', () => {
        pdfFileNames.innerHTML = '';
        Array.from(pdfInput.files).forEach(f => {
            const div = document.createElement('div');
            div.className = 'file-name-item';
            div.textContent = f.name;
            pdfFileNames.appendChild(div);
        });
    });

    // Reset forms & hide download buttons after click
    document.querySelectorAll('.download').forEach(btn => {
        btn.addEventListener('click', () => {
            document.getElementById('image-to-pdf-form').reset();
            document.getElementById('pdf-to-image-form').reset();
            imageFileNames.innerHTML = '';
            pdfFileNames.innerHTML = '';

            setTimeout(() => {
                btn.style.display = 'none';
            }, 200); // allow download to start
        });
    });
</script>
{% endblock %}
